<p-fluid>
    <div class="flex flex-col mt-8 gap-6">
        <form [formGroup]="departmentForm" (ngSubmit)="onSubmit()" class="w-full">
            <div class="card flex flex-col gap-6 w-full">
                <div class="font-semibold text-xl">Create Department</div>

                <div class="flex flex-col md:flex-row gap-6">
                    <div class="flex flex-wrap gap-2 w-full">
                        <label for="companyId">Company ID*</label>
                        <input pInputText id="companyId" type="text" formControlName="Companyid"
                            [ngClass]="{'ng-invalid ng-dirty': isFieldInvalid('Companyid')}" />
                        <small class="text-red-500" *ngIf="isFieldInvalid('Companyid')">
                            {{getErrorMessage('Companyid')}}
                        </small>
                    </div>
                    <div class="flex flex-wrap gap-2 w-full">
                        <label for="departmentName">Department Name*</label>
                        <input pInputText id="departmentName" type="text" formControlName="Name"
                            [ngClass]="{'ng-invalid ng-dirty': isFieldInvalid('Name')}" />
                        <small class="text-red-500" *ngIf="isFieldInvalid('Name')">
                            {{getErrorMessage('Name')}}
                        </small>
                    </div>
                </div>

                <div class="flex flex-col md:flex-row gap-6">
                    <div class="flex flex-col gap-4 justify-center w-full">
                        <div class="flex items-center">
                            <p-checkbox formControlName="isActive" [binary]="true" inputId="isActive"></p-checkbox>
                            <label for="isActive" class="ml-2">Is Active</label>
                        </div>
                    </div>
                </div>

                <div class="flex gap-3">
                    <p-button type="submit" label="Submit" severity="primary"></p-button>
                    <p-button type="button" label="Reset" severity="secondary" (onClick)="onReset()"></p-button>
                </div>
            </div>
        </form>

        <!-- Department Table -->
        <div class="w-full mt-6">
            <p-table
                #dt
                [value]="departments"
                [rows]="10"
                [paginator]="true"
                [globalFilterFields]="['Companyid', 'Name']"
                [tableStyle]="{ 'min-width': '75rem' }"
                [rowHover]="true"
                dataKey="id"
                currentPageReportTemplate="Showing {first} to {last} of {totalRecords} departments"
                [showCurrentPageReport]="true"
                [rowsPerPageOptions]="[10, 20, 30]"
            >
                <ng-template #caption>
                    <div class="flex items-center justify-between">
                        <h5 class="m-0">Departments Record</h5>
                        <p-iconfield>
                            <p-inputicon styleClass="pi pi-search" />
                            <input pInputText type="text" (input)="onGlobalFilter(dt, $event)" placeholder="Search..." />
                        </p-iconfield>
                    </div>
                </ng-template>
                <ng-template #header>
                    <tr>
                        <th pSortableColumn="Companyid" style="min-width: 16rem">
                            Company ID
                            <p-sortIcon field="Companyid" />
                        </th>
                        <th pSortableColumn="Name" style="min-width: 16rem">
                            Department Name
                            <p-sortIcon field="Name" />
                        </th>
                        <th pSortableColumn="isActive" style="min-width: 12rem">
                            Status
                            <p-sortIcon field="isActive" />
                        </th>
                        <th style="min-width: 12rem">Actions</th>
                    </tr>
                </ng-template>
                <ng-template #body let-department>
                    <tr>
                        <td style="min-width: 16rem">{{ department.Companyid }}</td>
                        <td style="min-width: 16rem">{{ department.Name }}</td>
                        <td style="min-width: 12rem">
                            <p-tag [severity]="department.isActive ? 'success' : 'danger'" 
                                   [value]="department.isActive ? 'Active' : 'Inactive'" />
                        </td>
                        <td style="min-width: 12rem">
                            <p-button icon="pi pi-pencil" class="mr-2" [rounded]="true" [outlined]="true" />
                            <p-button icon="pi pi-trash" severity="danger" [rounded]="true" [outlined]="true" />
                        </td>
                    </tr>
                </ng-template>
                <ng-template #emptymessage>
                    <tr>
                        <td colspan="4" class="text-center p-4">No departments found.</td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>
</p-fluid>